{"ast":null,"code":"\"use strict\";\n\n/*\n * Copyright 2023 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NetworkProcessor = void 0;\nconst DefaultMap_1 = require(\"../../../utils/DefaultMap\");\nconst networkRequest_1 = require(\"./networkRequest\");\nclass NetworkProcessor {\n  #eventManager;\n  /**\n   * Map of request ID to NetworkRequest objects. Needed as long as information\n   * about requests comes from different events.\n   */\n  #requestMap;\n  constructor(eventManager) {\n    this.#eventManager = eventManager;\n    this.#requestMap = new DefaultMap_1.DefaultMap(requestId => new networkRequest_1.NetworkRequest(requestId, this.#eventManager));\n  }\n  static async create(cdpClient, eventManager) {\n    const networkProcessor = new NetworkProcessor(eventManager);\n    cdpClient.on('Network.requestWillBeSent', params => {\n      networkProcessor.#getOrCreateNetworkRequest(params.requestId).onRequestWillBeSentEvent(params);\n    });\n    cdpClient.on('Network.requestWillBeSentExtraInfo', params => {\n      networkProcessor.#getOrCreateNetworkRequest(params.requestId).onRequestWillBeSentExtraInfoEvent(params);\n    });\n    cdpClient.on('Network.responseReceived', params => {\n      networkProcessor.#getOrCreateNetworkRequest(params.requestId).onResponseReceivedEvent(params);\n    });\n    cdpClient.on('Network.responseReceivedExtraInfo', params => {\n      networkProcessor.#getOrCreateNetworkRequest(params.requestId).onResponseReceivedEventExtraInfo(params);\n    });\n    cdpClient.on('Network.loadingFailed', params => {\n      networkProcessor.#getOrCreateNetworkRequest(params.requestId).onLoadingFailedEvent(params);\n    });\n    await cdpClient.sendCommand('Network.enable');\n    return networkProcessor;\n  }\n  #getOrCreateNetworkRequest(requestId) {\n    return this.#requestMap.get(requestId);\n  }\n}\nexports.NetworkProcessor = NetworkProcessor;","map":{"version":3,"names":["DefaultMap_1","require","networkRequest_1","NetworkProcessor","eventManager","requestMap","constructor","DefaultMap","requestId","NetworkRequest","create","cdpClient","networkProcessor","on","params","getOrCreateNetworkRequest","onRequestWillBeSentEvent","onRequestWillBeSentExtraInfoEvent","onResponseReceivedEvent","onResponseReceivedEventExtraInfo","onLoadingFailedEvent","sendCommand","#getOrCreateNetworkRequest","get","exports"],"sources":["../../../../../src/bidiMapper/domains/network/networkProcessor.ts"],"sourcesContent":[null],"mappings":";;AAAA;;;;;;;;;;;;;;;;;;;;AA0BA,MAAAA,YAAA,GAAAC,OAAA;AAEA,MAAAC,gBAAA,GAAAD,OAAA;AAEA,MAAaE,gBAAgB;EAClB,CAAAC,YAAa;EAEtB;;;;EAIS,CAAAC,UAAW;EAEpBC,YAAoBF,YAA2B;IAC7C,IAAI,CAAC,CAAAA,YAAa,GAAGA,YAAY;IACjC,IAAI,CAAC,CAAAC,UAAW,GAAG,IAAIL,YAAA,CAAAO,UAAU,CAC9BC,SAAS,IAAK,IAAIN,gBAAA,CAAAO,cAAc,CAACD,SAAS,EAAE,IAAI,CAAC,CAAAJ,YAAa,CAAC,CACjE;EACH;EAEA,aAAaM,MAAMA,CACjBC,SAAoB,EACpBP,YAA2B;IAE3B,MAAMQ,gBAAgB,GAAG,IAAIT,gBAAgB,CAACC,YAAY,CAAC;IAE3DO,SAAS,CAACE,EAAE,CACV,2BAA2B,EAC1BC,MAA+C,IAAI;MAClDF,gBAAgB,CACb,CAAAG,yBAA0B,CAACD,MAAM,CAACN,SAAS,CAAC,CAC5CQ,wBAAwB,CAACF,MAAM,CAAC;IACrC,CAAC,CACF;IAEDH,SAAS,CAACE,EAAE,CACV,oCAAoC,EACnCC,MAAwD,IAAI;MAC3DF,gBAAgB,CACb,CAAAG,yBAA0B,CAACD,MAAM,CAACN,SAAS,CAAC,CAC5CS,iCAAiC,CAACH,MAAM,CAAC;IAC9C,CAAC,CACF;IAEDH,SAAS,CAACE,EAAE,CACV,0BAA0B,EACzBC,MAA8C,IAAI;MACjDF,gBAAgB,CACb,CAAAG,yBAA0B,CAACD,MAAM,CAACN,SAAS,CAAC,CAC5CU,uBAAuB,CAACJ,MAAM,CAAC;IACpC,CAAC,CACF;IAEDH,SAAS,CAACE,EAAE,CACV,mCAAmC,EAClCC,MAAuD,IAAI;MAC1DF,gBAAgB,CACb,CAAAG,yBAA0B,CAACD,MAAM,CAACN,SAAS,CAAC,CAC5CW,gCAAgC,CAACL,MAAM,CAAC;IAC7C,CAAC,CACF;IAEDH,SAAS,CAACE,EAAE,CACV,uBAAuB,EACtBC,MAA2C,IAAI;MAC9CF,gBAAgB,CACb,CAAAG,yBAA0B,CAACD,MAAM,CAACN,SAAS,CAAC,CAC5CY,oBAAoB,CAACN,MAAM,CAAC;IACjC,CAAC,CACF;IAED,MAAMH,SAAS,CAACU,WAAW,CAAC,gBAAgB,CAAC;IAE7C,OAAOT,gBAAgB;EACzB;EAEA,CAAAG,yBAA0BO,CAACd,SAAiB;IAC1C,OAAO,IAAI,CAAC,CAAAH,UAAW,CAACkB,GAAG,CAACf,SAAS,CAAC;EACxC;;AA1EFgB,OAAA,CAAArB,gBAAA,GAAAA,gBAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}