{"ast":null,"code":"\"use strict\";\n\n/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.setPageContent = exports.getReadableFromProtocolStream = exports.getReadableAsBuffer = exports.importFSPromises = exports.waitWithTimeout = exports.pageBindingInitString = exports.addPageBinding = exports.evaluationString = exports.createJSHandle = exports.waitForEvent = exports.isDate = exports.isRegExp = exports.isPlainObject = exports.isNumber = exports.isString = exports.removeEventListeners = exports.addEventListener = exports.releaseObject = exports.valueFromRemoteObject = exports.getExceptionMessage = exports.debugError = void 0;\nconst environment_js_1 = require(\"../environment.js\");\nconst assert_js_1 = require(\"../util/assert.js\");\nconst ErrorLike_js_1 = require(\"../util/ErrorLike.js\");\nconst Debug_js_1 = require(\"./Debug.js\");\nconst ElementHandle_js_1 = require(\"./ElementHandle.js\");\nconst Errors_js_1 = require(\"./Errors.js\");\nconst JSHandle_js_1 = require(\"./JSHandle.js\");\n/**\n * @internal\n */\nexports.debugError = (0, Debug_js_1.debug)('puppeteer:error');\n/**\n * @internal\n */\nfunction getExceptionMessage(exceptionDetails) {\n  if (exceptionDetails.exception) {\n    return exceptionDetails.exception.description || exceptionDetails.exception.value;\n  }\n  let message = exceptionDetails.text;\n  if (exceptionDetails.stackTrace) {\n    for (const callframe of exceptionDetails.stackTrace.callFrames) {\n      const location = callframe.url + ':' + callframe.lineNumber + ':' + callframe.columnNumber;\n      const functionName = callframe.functionName || '<anonymous>';\n      message += `\\n    at ${functionName} (${location})`;\n    }\n  }\n  return message;\n}\nexports.getExceptionMessage = getExceptionMessage;\n/**\n * @internal\n */\nfunction valueFromRemoteObject(remoteObject) {\n  (0, assert_js_1.assert)(!remoteObject.objectId, 'Cannot extract value when objectId is given');\n  if (remoteObject.unserializableValue) {\n    if (remoteObject.type === 'bigint') {\n      return BigInt(remoteObject.unserializableValue.replace('n', ''));\n    }\n    switch (remoteObject.unserializableValue) {\n      case '-0':\n        return -0;\n      case 'NaN':\n        return NaN;\n      case 'Infinity':\n        return Infinity;\n      case '-Infinity':\n        return -Infinity;\n      default:\n        throw new Error('Unsupported unserializable value: ' + remoteObject.unserializableValue);\n    }\n  }\n  return remoteObject.value;\n}\nexports.valueFromRemoteObject = valueFromRemoteObject;\n/**\n * @internal\n */\nasync function releaseObject(client, remoteObject) {\n  if (!remoteObject.objectId) {\n    return;\n  }\n  await client.send('Runtime.releaseObject', {\n    objectId: remoteObject.objectId\n  }).catch(error => {\n    // Exceptions might happen in case of a page been navigated or closed.\n    // Swallow these since they are harmless and we don't leak anything in this case.\n    (0, exports.debugError)(error);\n  });\n}\nexports.releaseObject = releaseObject;\n/**\n * @internal\n */\nfunction addEventListener(emitter, eventName, handler) {\n  emitter.on(eventName, handler);\n  return {\n    emitter,\n    eventName,\n    handler\n  };\n}\nexports.addEventListener = addEventListener;\n/**\n * @internal\n */\nfunction removeEventListeners(listeners) {\n  for (const listener of listeners) {\n    listener.emitter.removeListener(listener.eventName, listener.handler);\n  }\n  listeners.length = 0;\n}\nexports.removeEventListeners = removeEventListeners;\n/**\n * @internal\n */\nconst isString = obj => {\n  return typeof obj === 'string' || obj instanceof String;\n};\nexports.isString = isString;\n/**\n * @internal\n */\nconst isNumber = obj => {\n  return typeof obj === 'number' || obj instanceof Number;\n};\nexports.isNumber = isNumber;\n/**\n * @internal\n */\nconst isPlainObject = obj => {\n  return typeof obj === 'object' && (obj === null || obj === void 0 ? void 0 : obj.constructor) === Object;\n};\nexports.isPlainObject = isPlainObject;\n/**\n * @internal\n */\nconst isRegExp = obj => {\n  return typeof obj === 'object' && (obj === null || obj === void 0 ? void 0 : obj.constructor) === RegExp;\n};\nexports.isRegExp = isRegExp;\n/**\n * @internal\n */\nconst isDate = obj => {\n  return typeof obj === 'object' && (obj === null || obj === void 0 ? void 0 : obj.constructor) === Date;\n};\nexports.isDate = isDate;\n/**\n * @internal\n */\nasync function waitForEvent(emitter, eventName, predicate, timeout, abortPromise) {\n  let eventTimeout;\n  let resolveCallback;\n  let rejectCallback;\n  const promise = new Promise((resolve, reject) => {\n    resolveCallback = resolve;\n    rejectCallback = reject;\n  });\n  const listener = addEventListener(emitter, eventName, async event => {\n    if (!(await predicate(event))) {\n      return;\n    }\n    resolveCallback(event);\n  });\n  if (timeout) {\n    eventTimeout = setTimeout(() => {\n      rejectCallback(new Errors_js_1.TimeoutError('Timeout exceeded while waiting for event'));\n    }, timeout);\n  }\n  function cleanup() {\n    removeEventListeners([listener]);\n    clearTimeout(eventTimeout);\n  }\n  const result = await Promise.race([promise, abortPromise]).then(r => {\n    cleanup();\n    return r;\n  }, error => {\n    cleanup();\n    throw error;\n  });\n  if ((0, ErrorLike_js_1.isErrorLike)(result)) {\n    throw result;\n  }\n  return result;\n}\nexports.waitForEvent = waitForEvent;\n/**\n * @internal\n */\nfunction createJSHandle(context, remoteObject) {\n  if (remoteObject.subtype === 'node' && context._world) {\n    return new ElementHandle_js_1.CDPElementHandle(context, remoteObject, context._world.frame());\n  }\n  return new JSHandle_js_1.CDPJSHandle(context, remoteObject);\n}\nexports.createJSHandle = createJSHandle;\n/**\n * @internal\n */\nfunction evaluationString(fun, ...args) {\n  if ((0, exports.isString)(fun)) {\n    (0, assert_js_1.assert)(args.length === 0, 'Cannot evaluate a string with arguments');\n    return fun;\n  }\n  function serializeArgument(arg) {\n    if (Object.is(arg, undefined)) {\n      return 'undefined';\n    }\n    return JSON.stringify(arg);\n  }\n  return `(${fun})(${args.map(serializeArgument).join(',')})`;\n}\nexports.evaluationString = evaluationString;\n/**\n * @internal\n */\nfunction addPageBinding(type, name) {\n  // This is the CDP binding.\n  // @ts-expect-error: In a different context.\n  const callCDP = globalThis[name];\n  // We replace the CDP binding with a Puppeteer binding.\n  Object.assign(globalThis, {\n    [name](...args) {\n      var _a, _b, _c;\n      // This is the Puppeteer binding.\n      // @ts-expect-error: In a different context.\n      const callPuppeteer = globalThis[name];\n      (_a = callPuppeteer.args) !== null && _a !== void 0 ? _a : callPuppeteer.args = new Map();\n      (_b = callPuppeteer.callbacks) !== null && _b !== void 0 ? _b : callPuppeteer.callbacks = new Map();\n      const seq = ((_c = callPuppeteer.lastSeq) !== null && _c !== void 0 ? _c : 0) + 1;\n      callPuppeteer.lastSeq = seq;\n      callPuppeteer.args.set(seq, args);\n      callCDP(JSON.stringify({\n        type,\n        name,\n        seq,\n        args,\n        isTrivial: !args.some(value => {\n          return value instanceof Node;\n        })\n      }));\n      return new Promise((resolve, reject) => {\n        callPuppeteer.callbacks.set(seq, {\n          resolve(value) {\n            callPuppeteer.args.delete(seq);\n            resolve(value);\n          },\n          reject(value) {\n            callPuppeteer.args.delete(seq);\n            reject(value);\n          }\n        });\n      });\n    }\n  });\n}\nexports.addPageBinding = addPageBinding;\n/**\n * @internal\n */\nfunction pageBindingInitString(type, name) {\n  return evaluationString(addPageBinding, type, name);\n}\nexports.pageBindingInitString = pageBindingInitString;\n/**\n * @internal\n */\nasync function waitWithTimeout(promise, taskName, timeout) {\n  let reject;\n  const timeoutError = new Errors_js_1.TimeoutError(`waiting for ${taskName} failed: timeout ${timeout}ms exceeded`);\n  const timeoutPromise = new Promise((_, rej) => {\n    return reject = rej;\n  });\n  let timeoutTimer = null;\n  if (timeout) {\n    timeoutTimer = setTimeout(() => {\n      return reject(timeoutError);\n    }, timeout);\n  }\n  try {\n    return await Promise.race([promise, timeoutPromise]);\n  } finally {\n    if (timeoutTimer) {\n      clearTimeout(timeoutTimer);\n    }\n  }\n}\nexports.waitWithTimeout = waitWithTimeout;\n/**\n * @internal\n */\nlet fs = null;\n/**\n * @internal\n */\nasync function importFSPromises() {\n  if (!fs) {\n    try {\n      fs = await Promise.resolve().then(() => __importStar(require('fs/promises')));\n    } catch (error) {\n      if (error instanceof TypeError) {\n        throw new Error('Cannot write to a path outside of a Node-like environment.');\n      }\n      throw error;\n    }\n  }\n  return fs;\n}\nexports.importFSPromises = importFSPromises;\n/**\n * @internal\n */\nasync function getReadableAsBuffer(readable, path) {\n  const buffers = [];\n  if (path) {\n    const fs = await importFSPromises();\n    const fileHandle = await fs.open(path, 'w+');\n    for await (const chunk of readable) {\n      buffers.push(chunk);\n      await fileHandle.writeFile(chunk);\n    }\n    await fileHandle.close();\n  } else {\n    for await (const chunk of readable) {\n      buffers.push(chunk);\n    }\n  }\n  try {\n    return Buffer.concat(buffers);\n  } catch (error) {\n    return null;\n  }\n}\nexports.getReadableAsBuffer = getReadableAsBuffer;\n/**\n * @internal\n */\nasync function getReadableFromProtocolStream(client, handle) {\n  // TODO: Once Node 18 becomes the lowest supported version, we can migrate to\n  // ReadableStream.\n  if (!environment_js_1.isNode) {\n    throw new Error('Cannot create a stream outside of Node.js environment.');\n  }\n  const {\n    Readable\n  } = await Promise.resolve().then(() => __importStar(require('stream')));\n  let eof = false;\n  return new Readable({\n    async read(size) {\n      if (eof) {\n        return;\n      }\n      const response = await client.send('IO.read', {\n        handle,\n        size\n      });\n      this.push(response.data, response.base64Encoded ? 'base64' : undefined);\n      if (response.eof) {\n        eof = true;\n        await client.send('IO.close', {\n          handle\n        });\n        this.push(null);\n      }\n    }\n  });\n}\nexports.getReadableFromProtocolStream = getReadableFromProtocolStream;\n/**\n * @internal\n */\nasync function setPageContent(page, content) {\n  // We rely upon the fact that document.open() will reset frame lifecycle with \"init\"\n  // lifecycle event. @see https://crrev.com/608658\n  return page.evaluate(html => {\n    document.open();\n    document.write(html);\n    document.close();\n  }, content);\n}\nexports.setPageContent = setPageContent;","map":{"version":3,"names":["environment_js_1","require","assert_js_1","ErrorLike_js_1","Debug_js_1","ElementHandle_js_1","Errors_js_1","JSHandle_js_1","exports","debugError","debug","getExceptionMessage","exceptionDetails","exception","description","value","message","text","stackTrace","callframe","callFrames","location","url","lineNumber","columnNumber","functionName","valueFromRemoteObject","remoteObject","assert","objectId","unserializableValue","type","BigInt","replace","NaN","Infinity","Error","releaseObject","client","send","catch","error","addEventListener","emitter","eventName","handler","on","removeEventListeners","listeners","listener","removeListener","length","isString","obj","String","isNumber","Number","isPlainObject","constructor","Object","isRegExp","RegExp","isDate","Date","waitForEvent","predicate","timeout","abortPromise","eventTimeout","resolveCallback","rejectCallback","promise","Promise","resolve","reject","event","setTimeout","TimeoutError","cleanup","clearTimeout","result","race","then","r","isErrorLike","createJSHandle","context","subtype","_world","CDPElementHandle","frame","CDPJSHandle","evaluationString","fun","args","serializeArgument","arg","is","undefined","JSON","stringify","map","join","addPageBinding","name","callCDP","globalThis","assign","callPuppeteer","_a","Map","_b","callbacks","seq","_c","lastSeq","set","isTrivial","some","Node","delete","pageBindingInitString","waitWithTimeout","taskName","timeoutError","timeoutPromise","_","rej","timeoutTimer","fs","importFSPromises","__importStar","TypeError","getReadableAsBuffer","readable","path","buffers","fileHandle","open","chunk","push","writeFile","close","Buffer","concat","getReadableFromProtocolStream","handle","isNode","Readable","eof","read","size","response","data","base64Encoded","setPageContent","page","content","evaluate","html","document","write"],"sources":["../../../../src/common/util.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}