{"ast":null,"code":"\"use strict\";\n\n/**\n * Copyright 2023 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.resolveSystemExecutablePath = exports.resolveBuildId = exports.relativeExecutablePath = exports.resolveDownloadPath = exports.resolveDownloadUrl = void 0;\nconst path_1 = __importDefault(require(\"path\"));\nconst httpUtil_js_1 = require(\"../httpUtil.js\");\nconst types_js_1 = require(\"./types.js\");\nfunction folder(platform) {\n  switch (platform) {\n    case types_js_1.BrowserPlatform.LINUX:\n      return 'linux64';\n    case types_js_1.BrowserPlatform.MAC_ARM:\n      return 'mac-arm64';\n    case types_js_1.BrowserPlatform.MAC:\n      return 'mac-x64';\n    case types_js_1.BrowserPlatform.WIN32:\n      return 'win32';\n    case types_js_1.BrowserPlatform.WIN64:\n      return 'win64';\n  }\n}\nfunction chromiumDashPlatform(platform) {\n  switch (platform) {\n    case types_js_1.BrowserPlatform.LINUX:\n      return 'linux';\n    case types_js_1.BrowserPlatform.MAC_ARM:\n      return 'mac';\n    case types_js_1.BrowserPlatform.MAC:\n      return 'mac';\n    case types_js_1.BrowserPlatform.WIN32:\n      return 'win';\n    case types_js_1.BrowserPlatform.WIN64:\n      return 'win64';\n  }\n}\nfunction resolveDownloadUrl(platform, buildId, baseUrl = 'https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing') {\n  return `${baseUrl}/${resolveDownloadPath(platform, buildId).join('/')}`;\n}\nexports.resolveDownloadUrl = resolveDownloadUrl;\nfunction resolveDownloadPath(platform, buildId) {\n  return [buildId, folder(platform), `chrome-${folder(platform)}.zip`];\n}\nexports.resolveDownloadPath = resolveDownloadPath;\nfunction relativeExecutablePath(platform, _buildId) {\n  switch (platform) {\n    case types_js_1.BrowserPlatform.MAC:\n    case types_js_1.BrowserPlatform.MAC_ARM:\n      return path_1.default.join('chrome-' + folder(platform), 'Google Chrome for Testing.app', 'Contents', 'MacOS', 'Google Chrome for Testing');\n    case types_js_1.BrowserPlatform.LINUX:\n      return path_1.default.join('chrome-linux64', 'chrome');\n    case types_js_1.BrowserPlatform.WIN32:\n    case types_js_1.BrowserPlatform.WIN64:\n      return path_1.default.join('chrome-' + folder(platform), 'chrome.exe');\n  }\n}\nexports.relativeExecutablePath = relativeExecutablePath;\nasync function resolveBuildId(platform, channel = 'beta') {\n  return new Promise((resolve, reject) => {\n    const request = (0, httpUtil_js_1.httpRequest)(new URL(`https://chromiumdash.appspot.com/fetch_releases?platform=${chromiumDashPlatform(platform)}&channel=${channel}`), 'GET', response => {\n      let data = '';\n      if (response.statusCode && response.statusCode >= 400) {\n        return reject(new Error(`Got status code ${response.statusCode}`));\n      }\n      response.on('data', chunk => {\n        data += chunk;\n      });\n      response.on('end', () => {\n        try {\n          const response = JSON.parse(String(data));\n          return resolve(response[0].version);\n        } catch {\n          return reject(new Error('Chrome version not found'));\n        }\n      });\n    }, false);\n    request.on('error', err => {\n      reject(err);\n    });\n  });\n}\nexports.resolveBuildId = resolveBuildId;\nfunction resolveSystemExecutablePath(platform, channel) {\n  switch (platform) {\n    case types_js_1.BrowserPlatform.WIN64:\n    case types_js_1.BrowserPlatform.WIN32:\n      switch (channel) {\n        case types_js_1.ChromeReleaseChannel.STABLE:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`;\n        case types_js_1.ChromeReleaseChannel.BETA:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome Beta\\\\Application\\\\chrome.exe`;\n        case types_js_1.ChromeReleaseChannel.CANARY:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome SxS\\\\Application\\\\chrome.exe`;\n        case types_js_1.ChromeReleaseChannel.DEV:\n          return `${process.env['PROGRAMFILES']}\\\\Google\\\\Chrome Dev\\\\Application\\\\chrome.exe`;\n      }\n    case types_js_1.BrowserPlatform.MAC_ARM:\n    case types_js_1.BrowserPlatform.MAC:\n      switch (channel) {\n        case types_js_1.ChromeReleaseChannel.STABLE:\n          return '/Applications/Google Chrome.app/Contents/MacOS/Google Chrome';\n        case types_js_1.ChromeReleaseChannel.BETA:\n          return '/Applications/Google Chrome Beta.app/Contents/MacOS/Google Chrome Beta';\n        case types_js_1.ChromeReleaseChannel.CANARY:\n          return '/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary';\n        case types_js_1.ChromeReleaseChannel.DEV:\n          return '/Applications/Google Chrome Dev.app/Contents/MacOS/Google Chrome Dev';\n      }\n    case types_js_1.BrowserPlatform.LINUX:\n      switch (channel) {\n        case types_js_1.ChromeReleaseChannel.STABLE:\n          return '/opt/google/chrome/chrome';\n        case types_js_1.ChromeReleaseChannel.BETA:\n          return '/opt/google/chrome-beta/chrome';\n        case types_js_1.ChromeReleaseChannel.DEV:\n          return '/opt/google/chrome-unstable/chrome';\n      }\n  }\n  throw new Error(`Unable to detect browser executable path for '${channel}' on ${platform}.`);\n}\nexports.resolveSystemExecutablePath = resolveSystemExecutablePath;","map":{"version":3,"names":["path_1","__importDefault","require","httpUtil_js_1","types_js_1","folder","platform","BrowserPlatform","LINUX","MAC_ARM","MAC","WIN32","WIN64","chromiumDashPlatform","resolveDownloadUrl","buildId","baseUrl","resolveDownloadPath","join","exports","relativeExecutablePath","_buildId","default","resolveBuildId","channel","Promise","resolve","reject","request","httpRequest","URL","response","data","statusCode","Error","on","chunk","JSON","parse","String","version","err","resolveSystemExecutablePath","ChromeReleaseChannel","STABLE","process","env","BETA","CANARY","DEV"],"sources":["../../../src/browser-data/chrome.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}