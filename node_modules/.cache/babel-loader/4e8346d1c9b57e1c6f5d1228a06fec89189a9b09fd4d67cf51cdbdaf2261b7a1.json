{"ast":null,"code":"\"use strict\";\n\n/**\n * Copyright 2022 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BrowsingContextStorage = void 0;\nconst protocol_js_1 = require(\"../../../protocol/protocol.js\");\n/** Container class for browsing contexts. */\nclass BrowsingContextStorage {\n  /** Map from context ID to context implementation. */\n  #contexts = new Map();\n  /** Gets all top-level contexts, i.e. those with no parent. */\n  getTopLevelContexts() {\n    return this.getAllContexts().filter(c => c.isTopLevelContext());\n  }\n  /** Gets all contexts. */\n  getAllContexts() {\n    return Array.from(this.#contexts.values());\n  }\n  /** Deletes the context with the given ID. */\n  deleteContext(contextId) {\n    this.#contexts.delete(contextId);\n  }\n  /** Adds the given context. */\n  addContext(context) {\n    this.#contexts.set(context.contextId, context);\n    if (!context.isTopLevelContext()) {\n      this.getContext(context.parentId).addChild(context);\n    }\n  }\n  /** Returns true whether there is an existing context with the given ID. */\n  hasContext(contextId) {\n    return this.#contexts.has(contextId);\n  }\n  /** Gets the context with the given ID, if any. */\n  findContext(contextId) {\n    return this.#contexts.get(contextId);\n  }\n  /** Returns the top-level context ID of the given context, if any. */\n  findTopLevelContextId(contextId) {\n    if (contextId === null) {\n      return null;\n    }\n    const maybeContext = this.findContext(contextId);\n    const parentId = maybeContext?.parentId ?? null;\n    if (parentId === null) {\n      return contextId;\n    }\n    return this.findTopLevelContextId(parentId);\n  }\n  /** Gets the context with the given ID, if any, otherwise throws. */\n  getContext(contextId) {\n    const result = this.findContext(contextId);\n    if (result === undefined) {\n      throw new protocol_js_1.Message.NoSuchFrameException(`Context ${contextId} not found`);\n    }\n    return result;\n  }\n}\nexports.BrowsingContextStorage = BrowsingContextStorage;","map":{"version":3,"names":["protocol_js_1","require","BrowsingContextStorage","contexts","Map","getTopLevelContexts","getAllContexts","filter","c","isTopLevelContext","Array","from","values","deleteContext","contextId","delete","addContext","context","set","getContext","parentId","addChild","hasContext","has","findContext","get","findTopLevelContextId","maybeContext","result","undefined","Message","NoSuchFrameException","exports"],"sources":["../../../../../src/bidiMapper/domains/context/browsingContextStorage.ts"],"sourcesContent":[null],"mappings":";;AAAA;;;;;;;;;;;;;;;;;;;;AAiBA,MAAAA,aAAA,GAAAC,OAAA;AAIA;AACA,MAAaC,sBAAsB;EACjC;EACS,CAAAC,QAAS,GAAG,IAAIC,GAAG,EAGzB;EAEH;EACAC,mBAAmBA,CAAA;IACjB,OAAO,IAAI,CAACC,cAAc,EAAE,CAACC,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACC,iBAAiB,EAAE,CAAC;EACnE;EAEA;EACAH,cAAcA,CAAA;IACZ,OAAOI,KAAK,CAACC,IAAI,CAAC,IAAI,CAAC,CAAAR,QAAS,CAACS,MAAM,EAAE,CAAC;EAC5C;EAEA;EACAC,aAAaA,CAACC,SAA0C;IACtD,IAAI,CAAC,CAAAX,QAAS,CAACY,MAAM,CAACD,SAAS,CAAC;EAClC;EAEA;EACAE,UAAUA,CAACC,OAA4B;IACrC,IAAI,CAAC,CAAAd,QAAS,CAACe,GAAG,CAACD,OAAO,CAACH,SAAS,EAAEG,OAAO,CAAC;IAC9C,IAAI,CAACA,OAAO,CAACR,iBAAiB,EAAE,EAAE;MAChC,IAAI,CAACU,UAAU,CAACF,OAAO,CAACG,QAAS,CAAC,CAACC,QAAQ,CAACJ,OAAO,CAAC;;EAExD;EAEA;EACAK,UAAUA,CAACR,SAA0C;IACnD,OAAO,IAAI,CAAC,CAAAX,QAAS,CAACoB,GAAG,CAACT,SAAS,CAAC;EACtC;EAEA;EACAU,WAAWA,CACTV,SAA0C;IAE1C,OAAO,IAAI,CAAC,CAAAX,QAAS,CAACsB,GAAG,CAACX,SAAS,CAAC;EACtC;EAEA;EACAY,qBAAqBA,CACnBZ,SAAiD;IAEjD,IAAIA,SAAS,KAAK,IAAI,EAAE;MACtB,OAAO,IAAI;;IAEb,MAAMa,YAAY,GAAG,IAAI,CAACH,WAAW,CAACV,SAAS,CAAC;IAChD,MAAMM,QAAQ,GAAGO,YAAY,EAAEP,QAAQ,IAAI,IAAI;IAC/C,IAAIA,QAAQ,KAAK,IAAI,EAAE;MACrB,OAAON,SAAS;;IAElB,OAAO,IAAI,CAACY,qBAAqB,CAACN,QAAQ,CAAC;EAC7C;EAEA;EACAD,UAAUA,CAACL,SAA0C;IACnD,MAAMc,MAAM,GAAG,IAAI,CAACJ,WAAW,CAACV,SAAS,CAAC;IAC1C,IAAIc,MAAM,KAAKC,SAAS,EAAE;MACxB,MAAM,IAAI7B,aAAA,CAAA8B,OAAO,CAACC,oBAAoB,CAAC,WAAWjB,SAAS,YAAY,CAAC;;IAE1E,OAAOc,MAAM;EACf;;AAhEFI,OAAA,CAAA9B,sBAAA,GAAAA,sBAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}