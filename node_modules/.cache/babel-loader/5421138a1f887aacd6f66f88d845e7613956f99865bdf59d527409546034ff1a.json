{"ast":null,"code":"\"use strict\";\n\n/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nvar _BrowserFetcher_instances, _BrowserFetcher_product, _BrowserFetcher_downloadPath, _BrowserFetcher_downloadHost, _BrowserFetcher_platform, _BrowserFetcher_getFolderPath;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BrowserFetcher = void 0;\nconst child_process_1 = require(\"child_process\");\nconst fs_1 = require(\"fs\");\nconst promises_1 = require(\"fs/promises\");\nconst http_1 = __importDefault(require(\"http\"));\nconst https_1 = __importDefault(require(\"https\"));\nconst os_1 = __importDefault(require(\"os\"));\nconst path_1 = __importDefault(require(\"path\"));\nconst url_1 = __importDefault(require(\"url\"));\nconst util_1 = require(\"util\");\nconst extract_zip_1 = __importDefault(require(\"extract-zip\"));\nconst https_proxy_agent_1 = __importDefault(require(\"https-proxy-agent\"));\nconst proxy_from_env_1 = require(\"proxy-from-env\");\nconst tar_fs_1 = __importDefault(require(\"tar-fs\"));\nconst unbzip2_stream_1 = __importDefault(require(\"unbzip2-stream\"));\nconst Debug_js_1 = require(\"../common/Debug.js\");\nconst assert_js_1 = require(\"../util/assert.js\");\nconst fs_js_1 = require(\"./util/fs.js\");\nconst debugFetcher = (0, Debug_js_1.debug)('puppeteer:fetcher');\nconst downloadURLs = {\n  chrome: {\n    linux: '%s/chromium-browser-snapshots/Linux_x64/%d/%s.zip',\n    mac: '%s/chromium-browser-snapshots/Mac/%d/%s.zip',\n    mac_arm: '%s/chromium-browser-snapshots/Mac_Arm/%d/%s.zip',\n    win32: '%s/chromium-browser-snapshots/Win/%d/%s.zip',\n    win64: '%s/chromium-browser-snapshots/Win_x64/%d/%s.zip'\n  },\n  firefox: {\n    linux: '%s/firefox-%s.en-US.%s-x86_64.tar.bz2',\n    mac: '%s/firefox-%s.en-US.%s.dmg',\n    win32: '%s/firefox-%s.en-US.%s.zip',\n    win64: '%s/firefox-%s.en-US.%s.zip'\n  }\n};\nconst browserConfig = {\n  chrome: {\n    host: 'https://storage.googleapis.com'\n  },\n  firefox: {\n    host: 'https://archive.mozilla.org/pub/firefox/nightly/latest-mozilla-central'\n  }\n};\nconst exec = (0, util_1.promisify)(child_process_1.exec);\nfunction archiveName(product, platform, revision) {\n  switch (product) {\n    case 'chrome':\n      switch (platform) {\n        case 'linux':\n          return 'chrome-linux';\n        case 'mac_arm':\n        case 'mac':\n          return 'chrome-mac';\n        case 'win32':\n        case 'win64':\n          // Windows archive name changed at r591479.\n          return parseInt(revision, 10) > 591479 ? 'chrome-win' : 'chrome-win32';\n      }\n    case 'firefox':\n      return platform;\n  }\n}\nfunction downloadURL(product, platform, host, revision) {\n  const url = (0, util_1.format)(downloadURLs[product][platform], host, revision, archiveName(product, platform, revision));\n  return url;\n}\nfunction handleArm64() {\n  let exists = (0, fs_1.existsSync)('/usr/bin/chromium-browser');\n  if (exists) {\n    return;\n  }\n  exists = (0, fs_1.existsSync)('/usr/bin/chromium');\n  if (exists) {\n    return;\n  }\n  console.error('The chromium binary is not available for arm64.' + '\\nIf you are on Ubuntu, you can install with: ' + '\\n\\n sudo apt install chromium\\n' + '\\n\\n sudo apt install chromium-browser\\n');\n  throw new Error();\n}\n/**\n * BrowserFetcher can download and manage different versions of Chromium and\n * Firefox.\n *\n * @remarks\n * BrowserFetcher operates on revision strings that specify a precise version of\n * Chromium, e.g. `\"533271\"`. Revision strings can be obtained from\n * {@link http://omahaproxy.appspot.com/ | omahaproxy.appspot.com}. For Firefox,\n * BrowserFetcher downloads Firefox Nightly and operates on version numbers such\n * as `\"75\"`.\n *\n * @remarks\n * The default constructed fetcher will always be for Chromium unless otherwise\n * specified.\n *\n * @remarks\n * BrowserFetcher is not designed to work concurrently with other instances of\n * BrowserFetcher that share the same downloads directory.\n *\n * @example\n * An example of using BrowserFetcher to download a specific version of Chromium\n * and running Puppeteer against it:\n *\n * ```ts\n * const browserFetcher = new BrowserFetcher({path: 'path/to/download/folder'});\n * const revisionInfo = await browserFetcher.download('533271');\n * const browser = await puppeteer.launch({\n *   executablePath: revisionInfo.executablePath,\n * });\n * ```\n *\n * @public\n */\nclass BrowserFetcher {\n  /**\n   * Constructs a browser fetcher for the given options.\n   */\n  constructor(options) {\n    var _a, _b;\n    _BrowserFetcher_instances.add(this);\n    _BrowserFetcher_product.set(this, void 0);\n    _BrowserFetcher_downloadPath.set(this, void 0);\n    _BrowserFetcher_downloadHost.set(this, void 0);\n    _BrowserFetcher_platform.set(this, void 0);\n    __classPrivateFieldSet(this, _BrowserFetcher_product, (_a = options.product) !== null && _a !== void 0 ? _a : 'chrome', \"f\");\n    __classPrivateFieldSet(this, _BrowserFetcher_downloadPath, options.path, \"f\");\n    __classPrivateFieldSet(this, _BrowserFetcher_downloadHost, (_b = options.host) !== null && _b !== void 0 ? _b : browserConfig[__classPrivateFieldGet(this, _BrowserFetcher_product, \"f\")].host, \"f\");\n    if (options.platform) {\n      __classPrivateFieldSet(this, _BrowserFetcher_platform, options.platform, \"f\");\n    } else {\n      const platform = os_1.default.platform();\n      switch (platform) {\n        case 'darwin':\n          switch (__classPrivateFieldGet(this, _BrowserFetcher_product, \"f\")) {\n            case 'chrome':\n              __classPrivateFieldSet(this, _BrowserFetcher_platform, os_1.default.arch() === 'arm64' && options.useMacOSARMBinary ? 'mac_arm' : 'mac', \"f\");\n              break;\n            case 'firefox':\n              __classPrivateFieldSet(this, _BrowserFetcher_platform, 'mac', \"f\");\n              break;\n          }\n          break;\n        case 'linux':\n          __classPrivateFieldSet(this, _BrowserFetcher_platform, 'linux', \"f\");\n          break;\n        case 'win32':\n          __classPrivateFieldSet(this, _BrowserFetcher_platform, os_1.default.arch() === 'x64' ||\n          // Windows 11 for ARM supports x64 emulation\n          os_1.default.arch() === 'arm64' && isWindows11(os_1.default.release()) ? 'win64' : 'win32', \"f\");\n          return;\n        default:\n          (0, assert_js_1.assert)(false, 'Unsupported platform: ' + platform);\n      }\n    }\n    (0, assert_js_1.assert)(downloadURLs[__classPrivateFieldGet(this, _BrowserFetcher_product, \"f\")][__classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\")], 'Unsupported platform: ' + __classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\"));\n  }\n  /**\n   * Returns the current `Platform`, which is one of `mac`, `linux`,\n   * `win32` or `win64`.\n   */\n  platform() {\n    return __classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\");\n  }\n  /**\n   * Returns the current `Product`, which is one of `chrome` or\n   * `firefox`.\n   */\n  product() {\n    return __classPrivateFieldGet(this, _BrowserFetcher_product, \"f\");\n  }\n  /**\n   * The download host being used.\n   */\n  host() {\n    return __classPrivateFieldGet(this, _BrowserFetcher_downloadHost, \"f\");\n  }\n  /**\n   * Initiates a HEAD request to check if the revision is available.\n   * @remarks\n   * This method is affected by the current `product`.\n   * @param revision - The revision to check availability for.\n   * @returns A promise that resolves to `true` if the revision could be downloaded\n   * from the host.\n   */\n  canDownload(revision) {\n    const url = downloadURL(__classPrivateFieldGet(this, _BrowserFetcher_product, \"f\"), __classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\"), __classPrivateFieldGet(this, _BrowserFetcher_downloadHost, \"f\"), revision);\n    return new Promise(resolve => {\n      const request = httpRequest(url, 'HEAD', response => {\n        resolve(response.statusCode === 200);\n      }, false);\n      request.on('error', error => {\n        console.error(error);\n        resolve(false);\n      });\n    });\n  }\n  /**\n   * Initiates a GET request to download the revision from the host.\n   * @remarks\n   * This method is affected by the current `product`.\n   * @param revision - The revision to download.\n   * @param progressCallback - A function that will be called with two arguments:\n   * How many bytes have been downloaded and the total number of bytes of the download.\n   * @returns A promise with revision information when the revision is downloaded\n   * and extracted.\n   */\n  async download(revision, progressCallback = () => {}) {\n    const url = downloadURL(__classPrivateFieldGet(this, _BrowserFetcher_product, \"f\"), __classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\"), __classPrivateFieldGet(this, _BrowserFetcher_downloadHost, \"f\"), revision);\n    const fileName = url.split('/').pop();\n    (0, assert_js_1.assert)(fileName, `A malformed download URL was found: ${url}.`);\n    const archivePath = path_1.default.join(__classPrivateFieldGet(this, _BrowserFetcher_downloadPath, \"f\"), fileName);\n    const outputPath = __classPrivateFieldGet(this, _BrowserFetcher_instances, \"m\", _BrowserFetcher_getFolderPath).call(this, revision);\n    if ((0, fs_1.existsSync)(outputPath)) {\n      return this.revisionInfo(revision);\n    }\n    if (!(0, fs_1.existsSync)(__classPrivateFieldGet(this, _BrowserFetcher_downloadPath, \"f\"))) {\n      await (0, promises_1.mkdir)(__classPrivateFieldGet(this, _BrowserFetcher_downloadPath, \"f\"), {\n        recursive: true\n      });\n    }\n    // Use system Chromium builds on Linux ARM devices\n    if (os_1.default.platform() === 'linux' && os_1.default.arch() === 'arm64') {\n      handleArm64();\n      return;\n    }\n    try {\n      await _downloadFile(url, archivePath, progressCallback);\n      await install(archivePath, outputPath);\n    } finally {\n      if ((0, fs_1.existsSync)(archivePath)) {\n        await (0, promises_1.unlink)(archivePath);\n      }\n    }\n    const revisionInfo = this.revisionInfo(revision);\n    if (revisionInfo) {\n      await (0, promises_1.chmod)(revisionInfo.executablePath, 0o755);\n    }\n    return revisionInfo;\n  }\n  /**\n   * @remarks\n   * This method is affected by the current `product`.\n   * @returns A list of all revision strings (for the current `product`)\n   * available locally on disk.\n   */\n  localRevisions() {\n    if (!(0, fs_1.existsSync)(__classPrivateFieldGet(this, _BrowserFetcher_downloadPath, \"f\"))) {\n      return [];\n    }\n    const fileNames = (0, fs_1.readdirSync)(__classPrivateFieldGet(this, _BrowserFetcher_downloadPath, \"f\"));\n    return fileNames.map(fileName => {\n      return parseFolderPath(__classPrivateFieldGet(this, _BrowserFetcher_product, \"f\"), fileName);\n    }).filter(entry => {\n      var _a;\n      return (_a = entry && entry.platform === __classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\")) !== null && _a !== void 0 ? _a : false;\n    }).map(entry => {\n      return entry.revision;\n    });\n  }\n  /**\n   * @remarks\n   * This method is affected by the current `product`.\n   * @param revision - A revision to remove for the current `product`.\n   * @returns A promise that resolves when the revision has been removed or\n   * throws if the revision has not been downloaded.\n   */\n  async remove(revision) {\n    const folderPath = __classPrivateFieldGet(this, _BrowserFetcher_instances, \"m\", _BrowserFetcher_getFolderPath).call(this, revision);\n    (0, assert_js_1.assert)((0, fs_1.existsSync)(folderPath), `Failed to remove: revision ${revision} is not downloaded`);\n    await (0, fs_js_1.rm)(folderPath);\n  }\n  /**\n   * @param revision - The revision to get info for.\n   * @returns The revision info for the given revision.\n   */\n  revisionInfo(revision) {\n    const folderPath = __classPrivateFieldGet(this, _BrowserFetcher_instances, \"m\", _BrowserFetcher_getFolderPath).call(this, revision);\n    let executablePath = '';\n    switch (__classPrivateFieldGet(this, _BrowserFetcher_product, \"f\")) {\n      case 'chrome':\n        switch (__classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\")) {\n          case 'mac':\n          case 'mac_arm':\n            executablePath = path_1.default.join(folderPath, archiveName(__classPrivateFieldGet(this, _BrowserFetcher_product, \"f\"), __classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\"), revision), 'Chromium.app', 'Contents', 'MacOS', 'Chromium');\n            break;\n          case 'linux':\n            executablePath = path_1.default.join(folderPath, archiveName(__classPrivateFieldGet(this, _BrowserFetcher_product, \"f\"), __classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\"), revision), 'chrome');\n            break;\n          case 'win32':\n          case 'win64':\n            executablePath = path_1.default.join(folderPath, archiveName(__classPrivateFieldGet(this, _BrowserFetcher_product, \"f\"), __classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\"), revision), 'chrome.exe');\n            break;\n        }\n        break;\n      case 'firefox':\n        switch (__classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\")) {\n          case 'mac':\n          case 'mac_arm':\n            executablePath = path_1.default.join(folderPath, 'Firefox Nightly.app', 'Contents', 'MacOS', 'firefox');\n            break;\n          case 'linux':\n            executablePath = path_1.default.join(folderPath, 'firefox', 'firefox');\n            break;\n          case 'win32':\n          case 'win64':\n            executablePath = path_1.default.join(folderPath, 'firefox', 'firefox.exe');\n            break;\n        }\n    }\n    const url = downloadURL(__classPrivateFieldGet(this, _BrowserFetcher_product, \"f\"), __classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\"), __classPrivateFieldGet(this, _BrowserFetcher_downloadHost, \"f\"), revision);\n    const local = (0, fs_1.existsSync)(folderPath);\n    debugFetcher({\n      revision,\n      executablePath,\n      folderPath,\n      local,\n      url,\n      product: __classPrivateFieldGet(this, _BrowserFetcher_product, \"f\")\n    });\n    return {\n      revision,\n      executablePath,\n      folderPath,\n      local,\n      url,\n      product: __classPrivateFieldGet(this, _BrowserFetcher_product, \"f\")\n    };\n  }\n  /**\n   * @internal\n   */\n  getDownloadPath() {\n    return __classPrivateFieldGet(this, _BrowserFetcher_downloadPath, \"f\");\n  }\n}\nexports.BrowserFetcher = BrowserFetcher;\n_BrowserFetcher_product = new WeakMap(), _BrowserFetcher_downloadPath = new WeakMap(), _BrowserFetcher_downloadHost = new WeakMap(), _BrowserFetcher_platform = new WeakMap(), _BrowserFetcher_instances = new WeakSet(), _BrowserFetcher_getFolderPath = function _BrowserFetcher_getFolderPath(revision) {\n  return path_1.default.resolve(__classPrivateFieldGet(this, _BrowserFetcher_downloadPath, \"f\"), `${__classPrivateFieldGet(this, _BrowserFetcher_platform, \"f\")}-${revision}`);\n};\nfunction parseFolderPath(product, folderPath) {\n  const name = path_1.default.basename(folderPath);\n  const splits = name.split('-');\n  if (splits.length !== 2) {\n    return;\n  }\n  const [platform, revision] = splits;\n  if (!revision || !platform || !(platform in downloadURLs[product])) {\n    return;\n  }\n  return {\n    product,\n    platform,\n    revision\n  };\n}\n/**\n * Windows 11 is identified by 10.0.22000 or greater\n * @internal\n */\nfunction isWindows11(version) {\n  const parts = version.split('.');\n  if (parts.length > 2) {\n    const major = parseInt(parts[0], 10);\n    const minor = parseInt(parts[1], 10);\n    const patch = parseInt(parts[2], 10);\n    return major > 10 || major === 10 && minor > 0 || major === 10 && minor === 0 && patch >= 22000;\n  }\n  return false;\n}\n/**\n * @internal\n */\nfunction _downloadFile(url, destinationPath, progressCallback) {\n  debugFetcher(`Downloading binary from ${url}`);\n  let fulfill;\n  let reject;\n  const promise = new Promise((x, y) => {\n    fulfill = x;\n    reject = y;\n  });\n  let downloadedBytes = 0;\n  let totalBytes = 0;\n  const request = httpRequest(url, 'GET', response => {\n    if (response.statusCode !== 200) {\n      const error = new Error(`Download failed: server returned code ${response.statusCode}. URL: ${url}`);\n      // consume response data to free up memory\n      response.resume();\n      reject(error);\n      return;\n    }\n    const file = (0, fs_1.createWriteStream)(destinationPath);\n    file.on('finish', () => {\n      return fulfill();\n    });\n    file.on('error', error => {\n      return reject(error);\n    });\n    response.pipe(file);\n    totalBytes = parseInt(response.headers['content-length'], 10);\n    if (progressCallback) {\n      response.on('data', onData);\n    }\n  });\n  request.on('error', error => {\n    return reject(error);\n  });\n  return promise;\n  function onData(chunk) {\n    downloadedBytes += chunk.length;\n    progressCallback(downloadedBytes, totalBytes);\n  }\n}\nasync function install(archivePath, folderPath) {\n  debugFetcher(`Installing ${archivePath} to ${folderPath}`);\n  if (archivePath.endsWith('.zip')) {\n    await (0, extract_zip_1.default)(archivePath, {\n      dir: folderPath\n    });\n  } else if (archivePath.endsWith('.tar.bz2')) {\n    await extractTar(archivePath, folderPath);\n  } else if (archivePath.endsWith('.dmg')) {\n    await (0, promises_1.mkdir)(folderPath);\n    await installDMG(archivePath, folderPath);\n  } else {\n    throw new Error(`Unsupported archive format: ${archivePath}`);\n  }\n}\n/**\n * @internal\n */\nfunction extractTar(tarPath, folderPath) {\n  return new Promise((fulfill, reject) => {\n    const tarStream = tar_fs_1.default.extract(folderPath);\n    tarStream.on('error', reject);\n    tarStream.on('finish', fulfill);\n    const readStream = (0, fs_1.createReadStream)(tarPath);\n    readStream.pipe((0, unbzip2_stream_1.default)()).pipe(tarStream);\n  });\n}\n/**\n * @internal\n */\nasync function installDMG(dmgPath, folderPath) {\n  const {\n    stdout\n  } = await exec(`hdiutil attach -nobrowse -noautoopen \"${dmgPath}\"`);\n  const volumes = stdout.match(/\\/Volumes\\/(.*)/m);\n  if (!volumes) {\n    throw new Error(`Could not find volume path in ${stdout}`);\n  }\n  const mountPath = volumes[0];\n  try {\n    const fileNames = await (0, promises_1.readdir)(mountPath);\n    const appName = fileNames.find(item => {\n      return typeof item === 'string' && item.endsWith('.app');\n    });\n    if (!appName) {\n      throw new Error(`Cannot find app in ${mountPath}`);\n    }\n    const mountedPath = path_1.default.join(mountPath, appName);\n    debugFetcher(`Copying ${mountedPath} to ${folderPath}`);\n    await exec(`cp -R \"${mountedPath}\" \"${folderPath}\"`);\n  } finally {\n    debugFetcher(`Unmounting ${mountPath}`);\n    await exec(`hdiutil detach \"${mountPath}\" -quiet`);\n  }\n}\nfunction httpRequest(url, method, response, keepAlive = true) {\n  const urlParsed = url_1.default.parse(url);\n  let options = {\n    ...urlParsed,\n    method,\n    headers: keepAlive ? {\n      Connection: 'keep-alive'\n    } : undefined\n  };\n  const proxyURL = (0, proxy_from_env_1.getProxyForUrl)(url);\n  if (proxyURL) {\n    if (url.startsWith('http:')) {\n      const proxy = url_1.default.parse(proxyURL);\n      options = {\n        path: options.href,\n        host: proxy.hostname,\n        port: proxy.port\n      };\n    } else {\n      const parsedProxyURL = url_1.default.parse(proxyURL);\n      const proxyOptions = {\n        ...parsedProxyURL,\n        secureProxy: parsedProxyURL.protocol === 'https:'\n      };\n      options.agent = (0, https_proxy_agent_1.default)(proxyOptions);\n      options.rejectUnauthorized = false;\n    }\n  }\n  const requestCallback = res => {\n    if (res.statusCode && res.statusCode >= 300 && res.statusCode < 400 && res.headers.location) {\n      httpRequest(res.headers.location, method, response);\n    } else {\n      response(res);\n    }\n  };\n  const request = options.protocol === 'https:' ? https_1.default.request(options, requestCallback) : http_1.default.request(options, requestCallback);\n  request.end();\n  return request;\n}","map":{"version":3,"names":["child_process_1","require","fs_1","promises_1","http_1","__importDefault","https_1","os_1","path_1","url_1","util_1","extract_zip_1","https_proxy_agent_1","proxy_from_env_1","tar_fs_1","unbzip2_stream_1","Debug_js_1","assert_js_1","fs_js_1","debugFetcher","debug","downloadURLs","chrome","linux","mac","mac_arm","win32","win64","firefox","browserConfig","host","exec","promisify","archiveName","product","platform","revision","parseInt","downloadURL","url","format","handleArm64","exists","existsSync","console","error","Error","BrowserFetcher","constructor","options","_BrowserFetcher_product","set","_BrowserFetcher_downloadPath","_BrowserFetcher_downloadHost","_BrowserFetcher_platform","__classPrivateFieldSet","_a","path","_b","__classPrivateFieldGet","default","arch","useMacOSARMBinary","isWindows11","release","assert","canDownload","Promise","resolve","request","httpRequest","response","statusCode","on","download","progressCallback","fileName","split","pop","archivePath","join","outputPath","_BrowserFetcher_instances","_BrowserFetcher_getFolderPath","call","revisionInfo","mkdir","recursive","_downloadFile","install","unlink","chmod","executablePath","localRevisions","fileNames","readdirSync","map","parseFolderPath","filter","entry","remove","folderPath","rm","local","getDownloadPath","exports","name","basename","splits","length","version","parts","major","minor","patch","destinationPath","fulfill","reject","promise","x","y","downloadedBytes","totalBytes","resume","file","createWriteStream","pipe","headers","onData","chunk","endsWith","dir","extractTar","installDMG","tarPath","tarStream","extract","readStream","createReadStream","dmgPath","stdout","volumes","match","mountPath","readdir","appName","find","item","mountedPath","method","keepAlive","urlParsed","parse","Connection","undefined","proxyURL","getProxyForUrl","startsWith","proxy","href","hostname","port","parsedProxyURL","proxyOptions","secureProxy","protocol","agent","rejectUnauthorized","requestCallback","res","location","end"],"sources":["../../../../src/node/BrowserFetcher.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}