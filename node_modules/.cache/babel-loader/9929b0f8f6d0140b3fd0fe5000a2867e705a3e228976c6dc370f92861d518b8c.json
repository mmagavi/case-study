{"ast":null,"code":"\"use strict\";\n\n/**\n * Copyright 2019 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _LifecycleWatcher_instances, _LifecycleWatcher_expectedLifecycle, _LifecycleWatcher_frameManager, _LifecycleWatcher_frame, _LifecycleWatcher_timeout, _LifecycleWatcher_navigationRequest, _LifecycleWatcher_eventListeners, _LifecycleWatcher_initialLoaderId, _LifecycleWatcher_sameDocumentNavigationPromise, _LifecycleWatcher_lifecyclePromise, _LifecycleWatcher_newDocumentNavigationPromise, _LifecycleWatcher_terminationPromise, _LifecycleWatcher_timeoutPromise, _LifecycleWatcher_maximumTimer, _LifecycleWatcher_hasSameDocumentNavigation, _LifecycleWatcher_swapped, _LifecycleWatcher_navigationResponseReceived, _LifecycleWatcher_onRequest, _LifecycleWatcher_onRequestFailed, _LifecycleWatcher_onResponse, _LifecycleWatcher_onFrameDetached, _LifecycleWatcher_terminate, _LifecycleWatcher_createTimeoutPromise, _LifecycleWatcher_navigatedWithinDocument, _LifecycleWatcher_navigated, _LifecycleWatcher_frameSwapped, _LifecycleWatcher_checkLifecycleComplete;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LifecycleWatcher = void 0;\nconst assert_js_1 = require(\"../util/assert.js\");\nconst DeferredPromise_js_1 = require(\"../util/DeferredPromise.js\");\nconst Connection_js_1 = require(\"./Connection.js\");\nconst Errors_js_1 = require(\"./Errors.js\");\nconst FrameManager_js_1 = require(\"./FrameManager.js\");\nconst NetworkManager_js_1 = require(\"./NetworkManager.js\");\nconst util_js_1 = require(\"./util.js\");\nconst puppeteerToProtocolLifecycle = new Map([['load', 'load'], ['domcontentloaded', 'DOMContentLoaded'], ['networkidle0', 'networkIdle'], ['networkidle2', 'networkAlmostIdle']]);\nconst noop = () => {};\n/**\n * @internal\n */\nclass LifecycleWatcher {\n  constructor(frameManager, frame, waitUntil, timeout) {\n    _LifecycleWatcher_instances.add(this);\n    _LifecycleWatcher_expectedLifecycle.set(this, void 0);\n    _LifecycleWatcher_frameManager.set(this, void 0);\n    _LifecycleWatcher_frame.set(this, void 0);\n    _LifecycleWatcher_timeout.set(this, void 0);\n    _LifecycleWatcher_navigationRequest.set(this, null);\n    _LifecycleWatcher_eventListeners.set(this, void 0);\n    _LifecycleWatcher_initialLoaderId.set(this, void 0);\n    _LifecycleWatcher_sameDocumentNavigationPromise.set(this, (0, DeferredPromise_js_1.createDeferredPromise)());\n    _LifecycleWatcher_lifecyclePromise.set(this, (0, DeferredPromise_js_1.createDeferredPromise)());\n    _LifecycleWatcher_newDocumentNavigationPromise.set(this, (0, DeferredPromise_js_1.createDeferredPromise)());\n    _LifecycleWatcher_terminationPromise.set(this, (0, DeferredPromise_js_1.createDeferredPromise)());\n    _LifecycleWatcher_timeoutPromise.set(this, void 0);\n    _LifecycleWatcher_maximumTimer.set(this, void 0);\n    _LifecycleWatcher_hasSameDocumentNavigation.set(this, void 0);\n    _LifecycleWatcher_swapped.set(this, void 0);\n    _LifecycleWatcher_navigationResponseReceived.set(this, void 0);\n    if (Array.isArray(waitUntil)) {\n      waitUntil = waitUntil.slice();\n    } else if (typeof waitUntil === 'string') {\n      waitUntil = [waitUntil];\n    }\n    __classPrivateFieldSet(this, _LifecycleWatcher_initialLoaderId, frame._loaderId, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_expectedLifecycle, waitUntil.map(value => {\n      const protocolEvent = puppeteerToProtocolLifecycle.get(value);\n      (0, assert_js_1.assert)(protocolEvent, 'Unknown value for options.waitUntil: ' + value);\n      return protocolEvent;\n    }), \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_frameManager, frameManager, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_frame, frame, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_timeout, timeout, \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_eventListeners, [(0, util_js_1.addEventListener)(frameManager.client, Connection_js_1.CDPSessionEmittedEvents.Disconnected, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_terminate).bind(this, new Error('Navigation failed because browser has disconnected!'))), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManager_js_1.FrameManagerEmittedEvents.LifecycleEvent, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManager_js_1.FrameManagerEmittedEvents.FrameNavigatedWithinDocument, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_navigatedWithinDocument).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManager_js_1.FrameManagerEmittedEvents.FrameNavigated, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_navigated).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManager_js_1.FrameManagerEmittedEvents.FrameSwapped, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_frameSwapped).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\"), FrameManager_js_1.FrameManagerEmittedEvents.FrameDetached, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onFrameDetached).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\").networkManager, NetworkManager_js_1.NetworkManagerEmittedEvents.Request, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onRequest).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\").networkManager, NetworkManager_js_1.NetworkManagerEmittedEvents.Response, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onResponse).bind(this)), (0, util_js_1.addEventListener)(__classPrivateFieldGet(this, _LifecycleWatcher_frameManager, \"f\").networkManager, NetworkManager_js_1.NetworkManagerEmittedEvents.RequestFailed, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_onRequestFailed).bind(this))], \"f\");\n    __classPrivateFieldSet(this, _LifecycleWatcher_timeoutPromise, __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_createTimeoutPromise).call(this), \"f\");\n    __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n  }\n  async navigationResponse() {\n    var _a;\n    // Continue with a possibly null response.\n    await ((_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _a === void 0 ? void 0 : _a.catch(() => {}));\n    return __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\") ? __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\").response() : null;\n  }\n  sameDocumentNavigationPromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_sameDocumentNavigationPromise, \"f\");\n  }\n  newDocumentNavigationPromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_newDocumentNavigationPromise, \"f\");\n  }\n  lifecyclePromise() {\n    return __classPrivateFieldGet(this, _LifecycleWatcher_lifecyclePromise, \"f\");\n  }\n  timeoutOrTerminationPromise() {\n    return Promise.race([__classPrivateFieldGet(this, _LifecycleWatcher_timeoutPromise, \"f\"), __classPrivateFieldGet(this, _LifecycleWatcher_terminationPromise, \"f\")]);\n  }\n  dispose() {\n    (0, util_js_1.removeEventListeners)(__classPrivateFieldGet(this, _LifecycleWatcher_eventListeners, \"f\"));\n    __classPrivateFieldGet(this, _LifecycleWatcher_maximumTimer, \"f\") !== undefined && clearTimeout(__classPrivateFieldGet(this, _LifecycleWatcher_maximumTimer, \"f\"));\n  }\n}\nexports.LifecycleWatcher = LifecycleWatcher;\n_LifecycleWatcher_expectedLifecycle = new WeakMap(), _LifecycleWatcher_frameManager = new WeakMap(), _LifecycleWatcher_frame = new WeakMap(), _LifecycleWatcher_timeout = new WeakMap(), _LifecycleWatcher_navigationRequest = new WeakMap(), _LifecycleWatcher_eventListeners = new WeakMap(), _LifecycleWatcher_initialLoaderId = new WeakMap(), _LifecycleWatcher_sameDocumentNavigationPromise = new WeakMap(), _LifecycleWatcher_lifecyclePromise = new WeakMap(), _LifecycleWatcher_newDocumentNavigationPromise = new WeakMap(), _LifecycleWatcher_terminationPromise = new WeakMap(), _LifecycleWatcher_timeoutPromise = new WeakMap(), _LifecycleWatcher_maximumTimer = new WeakMap(), _LifecycleWatcher_hasSameDocumentNavigation = new WeakMap(), _LifecycleWatcher_swapped = new WeakMap(), _LifecycleWatcher_navigationResponseReceived = new WeakMap(), _LifecycleWatcher_instances = new WeakSet(), _LifecycleWatcher_onRequest = function _LifecycleWatcher_onRequest(request) {\n  var _a, _b;\n  if (request.frame() !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\") || !request.isNavigationRequest()) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_navigationRequest, request, \"f\");\n  // Resolve previous navigation response in case there are multiple\n  // navigation requests reported by the backend. This generally should not\n  // happen by it looks like it's possible.\n  (_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _a === void 0 ? void 0 : _a.resolve();\n  __classPrivateFieldSet(this, _LifecycleWatcher_navigationResponseReceived, (0, DeferredPromise_js_1.createDeferredPromise)(), \"f\");\n  if (request.response() !== null) {\n    (_b = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _b === void 0 ? void 0 : _b.resolve();\n  }\n}, _LifecycleWatcher_onRequestFailed = function _LifecycleWatcher_onRequestFailed(request) {\n  var _a, _b;\n  if (((_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\")) === null || _a === void 0 ? void 0 : _a._requestId) !== request._requestId) {\n    return;\n  }\n  (_b = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _b === void 0 ? void 0 : _b.resolve();\n}, _LifecycleWatcher_onResponse = function _LifecycleWatcher_onResponse(response) {\n  var _a, _b;\n  if (((_a = __classPrivateFieldGet(this, _LifecycleWatcher_navigationRequest, \"f\")) === null || _a === void 0 ? void 0 : _a._requestId) !== response.request()._requestId) {\n    return;\n  }\n  (_b = __classPrivateFieldGet(this, _LifecycleWatcher_navigationResponseReceived, \"f\")) === null || _b === void 0 ? void 0 : _b.resolve();\n}, _LifecycleWatcher_onFrameDetached = function _LifecycleWatcher_onFrameDetached(frame) {\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\") === frame) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_terminationPromise, \"f\").resolve(new Error('Navigating frame was detached'));\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_terminate = function _LifecycleWatcher_terminate(error) {\n  __classPrivateFieldGet(this, _LifecycleWatcher_terminationPromise, \"f\").resolve(error);\n}, _LifecycleWatcher_createTimeoutPromise = async function _LifecycleWatcher_createTimeoutPromise() {\n  if (!__classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\")) {\n    return new Promise(noop);\n  }\n  const errorMessage = 'Navigation timeout of ' + __classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\") + ' ms exceeded';\n  await new Promise(fulfill => {\n    return __classPrivateFieldSet(this, _LifecycleWatcher_maximumTimer, setTimeout(fulfill, __classPrivateFieldGet(this, _LifecycleWatcher_timeout, \"f\")), \"f\");\n  });\n  return new Errors_js_1.TimeoutError(errorMessage);\n}, _LifecycleWatcher_navigatedWithinDocument = function _LifecycleWatcher_navigatedWithinDocument(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_hasSameDocumentNavigation, true, \"f\");\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_navigated = function _LifecycleWatcher_navigated(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_frameSwapped = function _LifecycleWatcher_frameSwapped(frame) {\n  if (frame !== __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")) {\n    return;\n  }\n  __classPrivateFieldSet(this, _LifecycleWatcher_swapped, true, \"f\");\n  __classPrivateFieldGet(this, _LifecycleWatcher_instances, \"m\", _LifecycleWatcher_checkLifecycleComplete).call(this);\n}, _LifecycleWatcher_checkLifecycleComplete = function _LifecycleWatcher_checkLifecycleComplete() {\n  // We expect navigation to commit.\n  if (!checkLifecycle(__classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\"), __classPrivateFieldGet(this, _LifecycleWatcher_expectedLifecycle, \"f\"))) {\n    return;\n  }\n  __classPrivateFieldGet(this, _LifecycleWatcher_lifecyclePromise, \"f\").resolve();\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_hasSameDocumentNavigation, \"f\")) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_sameDocumentNavigationPromise, \"f\").resolve(undefined);\n  }\n  if (__classPrivateFieldGet(this, _LifecycleWatcher_swapped, \"f\") || __classPrivateFieldGet(this, _LifecycleWatcher_frame, \"f\")._loaderId !== __classPrivateFieldGet(this, _LifecycleWatcher_initialLoaderId, \"f\")) {\n    __classPrivateFieldGet(this, _LifecycleWatcher_newDocumentNavigationPromise, \"f\").resolve(undefined);\n  }\n  function checkLifecycle(frame, expectedLifecycle) {\n    for (const event of expectedLifecycle) {\n      if (!frame._lifecycleEvents.has(event)) {\n        return false;\n      }\n    }\n    for (const child of frame.childFrames()) {\n      if (child._hasStartedLoading && !checkLifecycle(child, expectedLifecycle)) {\n        return false;\n      }\n    }\n    return true;\n  }\n};","map":{"version":3,"names":["assert_js_1","require","DeferredPromise_js_1","Connection_js_1","Errors_js_1","FrameManager_js_1","NetworkManager_js_1","util_js_1","puppeteerToProtocolLifecycle","Map","noop","LifecycleWatcher","constructor","frameManager","frame","waitUntil","timeout","_LifecycleWatcher_expectedLifecycle","set","_LifecycleWatcher_frameManager","_LifecycleWatcher_frame","_LifecycleWatcher_timeout","_LifecycleWatcher_navigationRequest","_LifecycleWatcher_eventListeners","_LifecycleWatcher_initialLoaderId","_LifecycleWatcher_sameDocumentNavigationPromise","createDeferredPromise","_LifecycleWatcher_lifecyclePromise","_LifecycleWatcher_newDocumentNavigationPromise","_LifecycleWatcher_terminationPromise","_LifecycleWatcher_timeoutPromise","_LifecycleWatcher_maximumTimer","_LifecycleWatcher_hasSameDocumentNavigation","_LifecycleWatcher_swapped","_LifecycleWatcher_navigationResponseReceived","Array","isArray","slice","__classPrivateFieldSet","_loaderId","map","value","protocolEvent","get","assert","addEventListener","client","CDPSessionEmittedEvents","Disconnected","__classPrivateFieldGet","_LifecycleWatcher_instances","_LifecycleWatcher_terminate","bind","Error","FrameManagerEmittedEvents","LifecycleEvent","_LifecycleWatcher_checkLifecycleComplete","FrameNavigatedWithinDocument","_LifecycleWatcher_navigatedWithinDocument","FrameNavigated","_LifecycleWatcher_navigated","FrameSwapped","_LifecycleWatcher_frameSwapped","FrameDetached","_LifecycleWatcher_onFrameDetached","networkManager","NetworkManagerEmittedEvents","Request","_LifecycleWatcher_onRequest","Response","_LifecycleWatcher_onResponse","RequestFailed","_LifecycleWatcher_onRequestFailed","_LifecycleWatcher_createTimeoutPromise","call","navigationResponse","_a","catch","response","sameDocumentNavigationPromise","newDocumentNavigationPromise","lifecyclePromise","timeoutOrTerminationPromise","Promise","race","dispose","removeEventListeners","undefined","clearTimeout","exports","request","isNavigationRequest","resolve","_b","_requestId","error","errorMessage","fulfill","setTimeout","TimeoutError","checkLifecycle","expectedLifecycle","event","_lifecycleEvents","has","child","childFrames","_hasStartedLoading"],"sources":["../../../../src/common/LifecycleWatcher.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}