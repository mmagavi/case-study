{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createDeferredPromise = void 0;\nconst Errors_js_1 = require(\"../common/Errors.js\");\n/**\n * Creates and returns a promise along with the resolve/reject functions.\n *\n * If the promise has not been resolved/rejected within the `timeout` period,\n * the promise gets rejected with a timeout error. `timeout` has to be greater than 0 or\n * it is ignored.\n *\n * @internal\n */\nfunction createDeferredPromise(opts) {\n  let isResolved = false;\n  let isRejected = false;\n  let resolver;\n  let rejector;\n  const taskPromise = new Promise((resolve, reject) => {\n    resolver = resolve;\n    rejector = reject;\n  });\n  const timeoutId = opts && opts.timeout > 0 ? setTimeout(() => {\n    isRejected = true;\n    rejector(new Errors_js_1.TimeoutError(opts.message));\n  }, opts.timeout) : undefined;\n  return Object.assign(taskPromise, {\n    resolved: () => {\n      return isResolved;\n    },\n    finished: () => {\n      return isResolved || isRejected;\n    },\n    resolve: value => {\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n      }\n      isResolved = true;\n      resolver(value);\n    },\n    reject: err => {\n      clearTimeout(timeoutId);\n      isRejected = true;\n      rejector(err);\n    }\n  });\n}\nexports.createDeferredPromise = createDeferredPromise;","map":{"version":3,"names":["Errors_js_1","require","createDeferredPromise","opts","isResolved","isRejected","resolver","rejector","taskPromise","Promise","resolve","reject","timeoutId","timeout","setTimeout","TimeoutError","message","undefined","Object","assign","resolved","finished","value","clearTimeout","err","exports"],"sources":["../../../../src/util/DeferredPromise.ts"],"sourcesContent":[null],"mappings":";;;;;;AAAA,MAAAA,WAAA,GAAAC,OAAA;AAoBA;;;;;;;;;AASA,SAAgBC,qBAAqBA,CACnCC,IAA6B;EAE7B,IAAIC,UAAU,GAAG,KAAK;EACtB,IAAIC,UAAU,GAAG,KAAK;EACtB,IAAIC,QAA4B;EAChC,IAAIC,QAAoC;EACxC,MAAMC,WAAW,GAAG,IAAIC,OAAO,CAAI,CAACC,OAAO,EAAEC,MAAM,KAAI;IACrDL,QAAQ,GAAGI,OAAO;IAClBH,QAAQ,GAAGI,MAAM;EACnB,CAAC,CAAC;EACF,MAAMC,SAAS,GACbT,IAAI,IAAIA,IAAI,CAACU,OAAO,GAAG,CAAC,GACpBC,UAAU,CAAC,MAAK;IACdT,UAAU,GAAG,IAAI;IACjBE,QAAQ,CAAC,IAAIP,WAAA,CAAAe,YAAY,CAACZ,IAAI,CAACa,OAAO,CAAC,CAAC;EAC1C,CAAC,EAAEb,IAAI,CAACU,OAAO,CAAC,GAChBI,SAAS;EACf,OAAOC,MAAM,CAACC,MAAM,CAACX,WAAW,EAAE;IAChCY,QAAQ,EAAEA,CAAA,KAAK;MACb,OAAOhB,UAAU;IACnB,CAAC;IACDiB,QAAQ,EAAEA,CAAA,KAAK;MACb,OAAOjB,UAAU,IAAIC,UAAU;IACjC,CAAC;IACDK,OAAO,EAAGY,KAAQ,IAAI;MACpB,IAAIV,SAAS,EAAE;QACbW,YAAY,CAACX,SAAS,CAAC;;MAEzBR,UAAU,GAAG,IAAI;MACjBE,QAAQ,CAACgB,KAAK,CAAC;IACjB,CAAC;IACDX,MAAM,EAAGa,GAAa,IAAI;MACxBD,YAAY,CAACX,SAAS,CAAC;MACvBP,UAAU,GAAG,IAAI;MACjBE,QAAQ,CAACiB,GAAG,CAAC;IACf;GACD,CAAC;AACJ;AAtCAC,OAAA,CAAAvB,qBAAA,GAAAA,qBAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}