{"ast":null,"code":"\"use strict\";\n\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nvar _NodeWebSocketTransport_ws;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NodeWebSocketTransport = void 0;\n/**\n * Copyright 2018 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst ws_1 = __importDefault(require(\"ws\"));\nconst version_js_1 = require(\"../generated/version.js\");\n/**\n * @internal\n */\nclass NodeWebSocketTransport {\n  static create(url, headers) {\n    return new Promise((resolve, reject) => {\n      const ws = new ws_1.default(url, [], {\n        followRedirects: true,\n        perMessageDeflate: false,\n        maxPayload: 256 * 1024 * 1024,\n        headers: {\n          'User-Agent': `Puppeteer ${version_js_1.packageVersion}`,\n          ...headers\n        }\n      });\n      ws.addEventListener('open', () => {\n        return resolve(new NodeWebSocketTransport(ws));\n      });\n      ws.addEventListener('error', reject);\n    });\n  }\n  constructor(ws) {\n    _NodeWebSocketTransport_ws.set(this, void 0);\n    __classPrivateFieldSet(this, _NodeWebSocketTransport_ws, ws, \"f\");\n    __classPrivateFieldGet(this, _NodeWebSocketTransport_ws, \"f\").addEventListener('message', event => {\n      if (this.onmessage) {\n        this.onmessage.call(null, event.data);\n      }\n    });\n    __classPrivateFieldGet(this, _NodeWebSocketTransport_ws, \"f\").addEventListener('close', () => {\n      if (this.onclose) {\n        this.onclose.call(null);\n      }\n    });\n    // Silently ignore all errors - we don't know what to do with them.\n    __classPrivateFieldGet(this, _NodeWebSocketTransport_ws, \"f\").addEventListener('error', () => {});\n  }\n  send(message) {\n    __classPrivateFieldGet(this, _NodeWebSocketTransport_ws, \"f\").send(message);\n  }\n  close() {\n    __classPrivateFieldGet(this, _NodeWebSocketTransport_ws, \"f\").close();\n  }\n}\nexports.NodeWebSocketTransport = NodeWebSocketTransport;\n_NodeWebSocketTransport_ws = new WeakMap();","map":{"version":3,"names":["ws_1","__importDefault","require","version_js_1","NodeWebSocketTransport","create","url","headers","Promise","resolve","reject","ws","default","followRedirects","perMessageDeflate","maxPayload","packageVersion","addEventListener","constructor","_NodeWebSocketTransport_ws","set","__classPrivateFieldSet","__classPrivateFieldGet","event","onmessage","call","data","onclose","send","message","close","exports"],"sources":["../../../../src/common/NodeWebSocketTransport.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;;;;AAeA,MAAAA,IAAA,GAAAC,eAAA,CAAAC,OAAA;AAGA,MAAAC,YAAA,GAAAD,OAAA;AAEA;;;AAGA,MAAaE,sBAAsB;EACjC,OAAOC,MAAMA,CACXC,GAAW,EACXC,OAAgC;IAEhC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAI;MACrC,MAAMC,EAAE,GAAG,IAAIX,IAAA,CAAAY,OAAa,CAACN,GAAG,EAAE,EAAE,EAAE;QACpCO,eAAe,EAAE,IAAI;QACrBC,iBAAiB,EAAE,KAAK;QACxBC,UAAU,EAAE,GAAG,GAAG,IAAI,GAAG,IAAI;QAC7BR,OAAO,EAAE;UACP,YAAY,EAAE,aAAaJ,YAAA,CAAAa,cAAc,EAAE;UAC3C,GAAGT;;OAEN,CAAC;MAEFI,EAAE,CAACM,gBAAgB,CAAC,MAAM,EAAE,MAAK;QAC/B,OAAOR,OAAO,CAAC,IAAIL,sBAAsB,CAACO,EAAE,CAAC,CAAC;MAChD,CAAC,CAAC;MACFA,EAAE,CAACM,gBAAgB,CAAC,OAAO,EAAEP,MAAM,CAAC;IACtC,CAAC,CAAC;EACJ;EAMAQ,YAAYP,EAAiB;IAJ7BQ,0BAAA,CAAAC,GAAA;IAKEC,sBAAA,KAAI,EAAAF,0BAAA,EAAOR,EAAE;IACbW,sBAAA,KAAI,EAAAH,0BAAA,MAAI,CAACF,gBAAgB,CAAC,SAAS,EAAEM,KAAK,IAAG;MAC3C,IAAI,IAAI,CAACC,SAAS,EAAE;QAClB,IAAI,CAACA,SAAS,CAACC,IAAI,CAAC,IAAI,EAAEF,KAAK,CAACG,IAAI,CAAC;;IAEzC,CAAC,CAAC;IACFJ,sBAAA,KAAI,EAAAH,0BAAA,MAAI,CAACF,gBAAgB,CAAC,OAAO,EAAE,MAAK;MACtC,IAAI,IAAI,CAACU,OAAO,EAAE;QAChB,IAAI,CAACA,OAAO,CAACF,IAAI,CAAC,IAAI,CAAC;;IAE3B,CAAC,CAAC;IACF;IACAH,sBAAA,KAAI,EAAAH,0BAAA,MAAI,CAACF,gBAAgB,CAAC,OAAO,EAAE,MAAK,CAAE,CAAC,CAAC;EAC9C;EAEAW,IAAIA,CAACC,OAAe;IAClBP,sBAAA,KAAI,EAAAH,0BAAA,MAAI,CAACS,IAAI,CAACC,OAAO,CAAC;EACxB;EAEAC,KAAKA,CAAA;IACHR,sBAAA,KAAI,EAAAH,0BAAA,MAAI,CAACW,KAAK,EAAE;EAClB;;AAjDFC,OAAA,CAAA3B,sBAAA,GAAAA,sBAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}