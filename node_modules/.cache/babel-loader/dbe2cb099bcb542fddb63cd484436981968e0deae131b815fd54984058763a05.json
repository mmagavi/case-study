{"ast":null,"code":"import { TimeoutError } from '../common/Errors.js';\n/**\n * Creates and returns a promise along with the resolve/reject functions.\n *\n * If the promise has not been resolved/rejected within the `timeout` period,\n * the promise gets rejected with a timeout error. `timeout` has to be greater than 0 or\n * it is ignored.\n *\n * @internal\n */\nexport function createDeferredPromise(opts) {\n  let isResolved = false;\n  let isRejected = false;\n  let resolver;\n  let rejector;\n  const taskPromise = new Promise((resolve, reject) => {\n    resolver = resolve;\n    rejector = reject;\n  });\n  const timeoutId = opts && opts.timeout > 0 ? setTimeout(() => {\n    isRejected = true;\n    rejector(new TimeoutError(opts.message));\n  }, opts.timeout) : undefined;\n  return Object.assign(taskPromise, {\n    resolved: () => {\n      return isResolved;\n    },\n    finished: () => {\n      return isResolved || isRejected;\n    },\n    resolve: value => {\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n      }\n      isResolved = true;\n      resolver(value);\n    },\n    reject: err => {\n      clearTimeout(timeoutId);\n      isRejected = true;\n      rejector(err);\n    }\n  });\n}","map":{"version":3,"names":["TimeoutError","createDeferredPromise","opts","isResolved","isRejected","resolver","rejector","taskPromise","Promise","resolve","reject","timeoutId","timeout","setTimeout","message","undefined","Object","assign","resolved","finished","value","clearTimeout","err"],"sources":["../../../../src/util/DeferredPromise.ts"],"sourcesContent":[null],"mappings":"AAAA,SAAQA,YAAY,QAAO,qBAAqB;AAoBhD;;;;;;;;;AASA,OAAM,SAAUC,qBAAqBA,CACnCC,IAA6B;EAE7B,IAAIC,UAAU,GAAG,KAAK;EACtB,IAAIC,UAAU,GAAG,KAAK;EACtB,IAAIC,QAA4B;EAChC,IAAIC,QAAoC;EACxC,MAAMC,WAAW,GAAG,IAAIC,OAAO,CAAI,CAACC,OAAO,EAAEC,MAAM,KAAI;IACrDL,QAAQ,GAAGI,OAAO;IAClBH,QAAQ,GAAGI,MAAM;EACnB,CAAC,CAAC;EACF,MAAMC,SAAS,GACbT,IAAI,IAAIA,IAAI,CAACU,OAAO,GAAG,CAAC,GACpBC,UAAU,CAAC,MAAK;IACdT,UAAU,GAAG,IAAI;IACjBE,QAAQ,CAAC,IAAIN,YAAY,CAACE,IAAI,CAACY,OAAO,CAAC,CAAC;EAC1C,CAAC,EAAEZ,IAAI,CAACU,OAAO,CAAC,GAChBG,SAAS;EACf,OAAOC,MAAM,CAACC,MAAM,CAACV,WAAW,EAAE;IAChCW,QAAQ,EAAEA,CAAA,KAAK;MACb,OAAOf,UAAU;IACnB,CAAC;IACDgB,QAAQ,EAAEA,CAAA,KAAK;MACb,OAAOhB,UAAU,IAAIC,UAAU;IACjC,CAAC;IACDK,OAAO,EAAGW,KAAQ,IAAI;MACpB,IAAIT,SAAS,EAAE;QACbU,YAAY,CAACV,SAAS,CAAC;;MAEzBR,UAAU,GAAG,IAAI;MACjBE,QAAQ,CAACe,KAAK,CAAC;IACjB,CAAC;IACDV,MAAM,EAAGY,GAAa,IAAI;MACxBD,YAAY,CAACV,SAAS,CAAC;MACvBP,UAAU,GAAG,IAAI;MACjBE,QAAQ,CAACgB,GAAG,CAAC;IACf;GACD,CAAC;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}