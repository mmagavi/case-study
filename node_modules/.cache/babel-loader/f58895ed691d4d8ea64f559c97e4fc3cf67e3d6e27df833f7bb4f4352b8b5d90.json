{"ast":null,"code":"\"use strict\";\n\n/**\n * Copyright 2023 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.resolveBuildId = exports.relativeExecutablePath = exports.resolveDownloadPath = exports.resolveDownloadUrl = void 0;\nconst httpUtil_js_1 = require(\"../httpUtil.js\");\nconst types_js_1 = require(\"./types.js\");\nfunction archive(platform) {\n  switch (platform) {\n    case types_js_1.BrowserPlatform.LINUX:\n      return 'chromedriver_linux64';\n    case types_js_1.BrowserPlatform.MAC_ARM:\n      return 'chromedriver_mac_arm64';\n    case types_js_1.BrowserPlatform.MAC:\n      return 'chromedriver_mac64';\n    case types_js_1.BrowserPlatform.WIN32:\n    case types_js_1.BrowserPlatform.WIN64:\n      return 'chromedriver_win32';\n  }\n}\nfunction resolveDownloadUrl(platform, buildId, baseUrl = 'https://chromedriver.storage.googleapis.com') {\n  return `${baseUrl}/${resolveDownloadPath(platform, buildId).join('/')}`;\n}\nexports.resolveDownloadUrl = resolveDownloadUrl;\nfunction resolveDownloadPath(platform, buildId) {\n  return [buildId, `${archive(platform)}.zip`];\n}\nexports.resolveDownloadPath = resolveDownloadPath;\nfunction relativeExecutablePath(platform, _buildId) {\n  switch (platform) {\n    case types_js_1.BrowserPlatform.MAC:\n    case types_js_1.BrowserPlatform.MAC_ARM:\n    case types_js_1.BrowserPlatform.LINUX:\n      return 'chromedriver';\n    case types_js_1.BrowserPlatform.WIN32:\n    case types_js_1.BrowserPlatform.WIN64:\n      return 'chromedriver.exe';\n  }\n}\nexports.relativeExecutablePath = relativeExecutablePath;\nasync function resolveBuildId(_channel = 'latest') {\n  return new Promise((resolve, reject) => {\n    const request = (0, httpUtil_js_1.httpRequest)(new URL(`https://chromedriver.storage.googleapis.com/LATEST_RELEASE`), 'GET', response => {\n      let data = '';\n      if (response.statusCode && response.statusCode >= 400) {\n        return reject(new Error(`Got status code ${response.statusCode}`));\n      }\n      response.on('data', chunk => {\n        data += chunk;\n      });\n      response.on('end', () => {\n        try {\n          return resolve(String(data));\n        } catch {\n          return reject(new Error('Chrome version not found'));\n        }\n      });\n    }, false);\n    request.on('error', err => {\n      reject(err);\n    });\n  });\n}\nexports.resolveBuildId = resolveBuildId;","map":{"version":3,"names":["httpUtil_js_1","require","types_js_1","archive","platform","BrowserPlatform","LINUX","MAC_ARM","MAC","WIN32","WIN64","resolveDownloadUrl","buildId","baseUrl","resolveDownloadPath","join","exports","relativeExecutablePath","_buildId","resolveBuildId","_channel","Promise","resolve","reject","request","httpRequest","URL","response","data","statusCode","Error","on","chunk","String","err"],"sources":["../../../src/browser-data/chromedriver.ts"],"sourcesContent":[null],"mappings":";;AAAA;;;;;;;;;;;;;;;;;;;AAgBA,MAAAA,aAAA,GAAAC,OAAA;AAEA,MAAAC,UAAA,GAAAD,OAAA;AAEA,SAASE,OAAOA,CAACC,QAAyB;EACxC,QAAQA,QAAQ;IACd,KAAKF,UAAA,CAAAG,eAAe,CAACC,KAAK;MACxB,OAAO,sBAAsB;IAC/B,KAAKJ,UAAA,CAAAG,eAAe,CAACE,OAAO;MAC1B,OAAO,wBAAwB;IACjC,KAAKL,UAAA,CAAAG,eAAe,CAACG,GAAG;MACtB,OAAO,oBAAoB;IAC7B,KAAKN,UAAA,CAAAG,eAAe,CAACI,KAAK;IAC1B,KAAKP,UAAA,CAAAG,eAAe,CAACK,KAAK;MACxB,OAAO,oBAAoB;;AAEjC;AAEA,SAAgBC,kBAAkBA,CAChCP,QAAyB,EACzBQ,OAAe,EACfC,OAAO,GAAG,6CAA6C;EAEvD,OAAO,GAAGA,OAAO,IAAIC,mBAAmB,CAACV,QAAQ,EAAEQ,OAAO,CAAC,CAACG,IAAI,CAAC,GAAG,CAAC,EAAE;AACzE;AANAC,OAAA,CAAAL,kBAAA,GAAAA,kBAAA;AAQA,SAAgBG,mBAAmBA,CACjCV,QAAyB,EACzBQ,OAAe;EAEf,OAAO,CAACA,OAAO,EAAE,GAAGT,OAAO,CAACC,QAAQ,CAAC,MAAM,CAAC;AAC9C;AALAY,OAAA,CAAAF,mBAAA,GAAAA,mBAAA;AAOA,SAAgBG,sBAAsBA,CACpCb,QAAyB,EACzBc,QAAgB;EAEhB,QAAQd,QAAQ;IACd,KAAKF,UAAA,CAAAG,eAAe,CAACG,GAAG;IACxB,KAAKN,UAAA,CAAAG,eAAe,CAACE,OAAO;IAC5B,KAAKL,UAAA,CAAAG,eAAe,CAACC,KAAK;MACxB,OAAO,cAAc;IACvB,KAAKJ,UAAA,CAAAG,eAAe,CAACI,KAAK;IAC1B,KAAKP,UAAA,CAAAG,eAAe,CAACK,KAAK;MACxB,OAAO,kBAAkB;;AAE/B;AAbAM,OAAA,CAAAC,sBAAA,GAAAA,sBAAA;AAcO,eAAeE,cAAcA,CAClCC,QAAA,GAAqB,QAAQ;EAE7B,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAI;IACrC,MAAMC,OAAO,GAAG,IAAAxB,aAAA,CAAAyB,WAAW,EACzB,IAAIC,GAAG,CAAC,4DAA4D,CAAC,EACrE,KAAK,EACLC,QAAQ,IAAG;MACT,IAAIC,IAAI,GAAG,EAAE;MACb,IAAID,QAAQ,CAACE,UAAU,IAAIF,QAAQ,CAACE,UAAU,IAAI,GAAG,EAAE;QACrD,OAAON,MAAM,CAAC,IAAIO,KAAK,CAAC,mBAAmBH,QAAQ,CAACE,UAAU,EAAE,CAAC,CAAC;;MAEpEF,QAAQ,CAACI,EAAE,CAAC,MAAM,EAAEC,KAAK,IAAG;QAC1BJ,IAAI,IAAII,KAAK;MACf,CAAC,CAAC;MACFL,QAAQ,CAACI,EAAE,CAAC,KAAK,EAAE,MAAK;QACtB,IAAI;UACF,OAAOT,OAAO,CAACW,MAAM,CAACL,IAAI,CAAC,CAAC;SAC7B,CAAC,MAAM;UACN,OAAOL,MAAM,CAAC,IAAIO,KAAK,CAAC,0BAA0B,CAAC,CAAC;;MAExD,CAAC,CAAC;IACJ,CAAC,EACD,KAAK,CACN;IACDN,OAAO,CAACO,EAAE,CAAC,OAAO,EAAEG,GAAG,IAAG;MACxBX,MAAM,CAACW,GAAG,CAAC;IACb,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ;AA7BAlB,OAAA,CAAAG,cAAA,GAAAA,cAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}